# branch

**目次**
- [基礎](#基礎)
  - [ブランチの作成](#ブランチの作成)
  - [ブランチの移動](#ブランチの移動)
  - [開発](#開発)
    - [ローカルのmasterブランチでの変更を取り込む際](#ローカルのmasterブランチでの変更を取り込む際)
  - [リモートリポジトリの内容をローカルリポジトリの内容に反映させる](#リモートリポジトリの内容をローカルリポジトリの内容に反映させる)
- [作業途中で別のブランチに移動](#作業途中で別のブランチに移動)
  - [退避](#退避)
  - [退避作業を見る](#退避作業を見る)
  - [退避した作業を元に戻す（履歴も削除する）](#退避した作業を元に戻す履歴も削除する)
  - [退避した作業を元に戻す(履歴は削除しない)](#退避した作業を元に戻す履歴は削除しない)
  - [退避した作業を消す](#退避した作業を消す)
- [ローカルブランチをリモートに追加](#ローカルブランチをリモートに追加)
- [リモートブランチをローカルに持ってくる](#リモートブランチをローカルに持ってくる)
- [リモートリポジトリを削除する](#リモートリポジトリを削除する)

## 基礎

### ブランチの作成

新規ブランチを作成したい場合は枝分かれしたいブランチ上で以下のコマンドを行う。
```bash
git branch <ANY_NAME>
git branch # 全てのブランチの確認
```

### ブランチの移動

作成したブランチに移動するには以下のコマンドで移動する
```bash
git checkout <BRANCH_NAME>
# コミットしていないファイルは消えるので注意
```

### 開発

移動したブランチでの開発は通常通りに行う。
変更したモノを追跡対象に追加してcommitを行うことで反映させる。
```bash
git add <ANY_FILE>
git commit -m "comment"
```
注意すべきなことは開発したブランチを`master`ブランチに取り込ませることである。
`master`ブランチに取り込ませる際には、まず開発中に変更された`master`ブランチの内容を取り込むことである。

#### ローカルのmasterブランチでの変更を取り込む際

```bash
# 開発用ブランチ上で
git merge master
```
この際にコンフリクト(衝突)が発生する場合がある。
その場合はコンフリクト内容を解消しなければならない。

### リモートリポジトリの内容をローカルリポジトリの内容に反映させる

リモートリポジトリの内容をローカルリポジトリに反映するには以下の方法を使う  
コレは他のPCや他の人が編集した内容をローカルに反映させる際に使用する。

```bash
git fetch origin master # リモートリポジトリから更新情報をダウンロードする
git merge origin/master # 更新情報を取り込む
```

- 一括で行うコマンド( fetch + merge )
```bash
git pull origin master
```


## 作業途中で別のブランチに移動

作業途中でブランチを移動する際に作業を退避しておく必要がある

### 退避

```bash
$ git stash -u
```

### 退避作業を見る

```bash
$ git stash list
```

### 退避した作業を元に戻す（履歴も削除する）
```bash
$ git stash pop stash@{0} # FILO
```

### 退避した作業を元に戻す(履歴は削除しない)
```bash
$ git stash apply stash@{0}
```

### 退避した作業を消す
```bash
$ git stash drop stash@{0}
```


参考:<https://qiita.com/chihiro/items/f373873d5c2dfbd03250>
参考:<http://webdev.boy.jp/git%E4%BD%9C%E6%A5%AD%E9%80%94%E4%B8%AD%E3%81%A7%E5%88%A5%E3%81%AE%E3%83%96%E3%83%A9%E3%83%B3%E3%83%81%E3%81%B8%E7%A7%BB%E5%8B%95%E3%81%97%E3%81%9F%E3%81%84/>

## ローカルブランチをリモートに追加

作成したローカルブランチを master に反映せずにリモートに追加した場合がある。
その際には以下のコマンドでリモートに追加することができる。
初回は以下のコマンドを用いる

```bash
git push -u origin BRANCH_NAME #初回
git push origin BRANCH_NAME # 二回目移行
```

- 参考
<https://blog.pokechoi.com/archives/1100>

## リモートブランチをローカルに持ってくる

追加したリモートブランチをローカルに持ってくる場合、以下の工程が必要である。
1. リモート追跡ブランチ(`orgin/hoge`)に `fetch` コマンドを使ってダウンロード
1. 追跡ブランチから`checkout -b`コマンドを使ってローカルブランチを作成する。

```bash
git fetch origin BRANCH_NAME
git checkout -b NEW_BRANCH origin/BRANCH_NAME
```

- 参考
<https://qiita.com/bitarx/items/ad47c9b91ae9c8272b3f>

## リモートリポジトリを削除する

リモートブランチが必要なくなった時に削除する際には以下のコマンドで削除できる。  
(例えばブランチを実行環境で動作確認した後にmasterへ取り組んだとか)

```bash
git push --delete origin BRANCH_NAME
```



